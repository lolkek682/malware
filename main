Write-Output "4eck3r Anti-malware"

$filePath = Read-Host "Введите путь к файлу для сканирования"

if (-not (Test-Path $filePath)) {
    Write-Output "Файл не найден. Пожалуйста, убедитесь в правильности пути и повторите попытку."
    Exit
}

$fileBytes = [System.IO.File]::ReadAllBytes($filePath)
$fileBase64 = [System.Convert]::ToBase64String($fileBytes)

$apiKey = "8f221280ec5f8c7a87ce7d1a6f46f7d743d4821ff8f7c43c940e82509c7fda55"
$url = "https://www.virustotal.com/vtapi/v2/file/scan"
$headers = @{"x-apikey" = $apiKey}
$body = @{"file" = $fileBase64}

$response = Invoke-RestMethod -Uri $url -Method Post -Headers $headers -Body $body

Write-Output $response
